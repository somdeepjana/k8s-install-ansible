---

- name: Initiate kubeadm control machine 
  command: kubeadm init --pod-network-cidr={{ network_cider }} --apiserver-advertise-address={{ ansible_ssh_host }} --apiserver-cert-extra-sans={{ ansible_ssh_host }}

- import_tasks: admin-setup.yml

- ansible.builtin.import_role: 
    name: cni
    
# - name: Pause for 10 second to fill the cni binaries
#   pause:
#     seconds: 20

# - name: restart crio for new iptable entries to take effect
#   ansible.builtin.systemd:
#       name: "{{ item }}"
#       state: restarted
#       daemon_reload: yes
#   loop:
#     - crio
#     - kubelet
